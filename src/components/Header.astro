---


import { Icon } from 'astro-icon/components';


const { lang = 'ko' } = Astro.props;
const base = lang === 'ko' ? '/ko' : '/en';
const links = [
  {
    label: lang === 'ko' ? 'Products' : 'Products',
    icon: 'mdi:category',
    subLinks: [
      { href: `${base}/products?category=Thermal camera`, label: lang === 'ko' ? '열화상 카메라' : 'Thermal Camera' },
      { href: `${base}/products?category=Lens`, label: lang === 'ko' ? '렌즈' : 'Lens' },
      { href: `${base}/products?category=Housing`, label: lang === 'ko' ? '하우징' : 'Housing' },
      { href: `${base}/products?category=Accessory`, label: lang === 'ko' ? '액세서리' : 'Accessory' },
    ]
  },
  { href: `${base}/solutions`, label: 'Solutions', icon: 'mdi:lightbulb-on' },
  { href: `${base}/about`, label: 'About', icon: 'mdi:information' },
  {
    label: lang === 'ko' ? 'Support' : 'Support',
    icon: 'mdi:help-circle',
    subLinks: [
      { href: `${base}/support/technical`, label: lang === 'ko' ? '기술지원' : 'Technical Support' },
      { href: `${base}/support/repair`, label: lang === 'ko' ? '수리접수' : 'Repair Request' },
    ]
  },
];
---
<header class="sticky top-0 z-40 bg-white shadow-sm">
  <!-- Top Bar -->
  <div class="bg-surface-2 text-on-surface-variant text-sm py-2">
    <div class="container mx-auto px-4 flex justify-end items-center">
      <div class="flex items-center gap-2">
        <a href="/ko" title="한국어" class:list={["p-1 rounded-full hover:bg-surface-3 transition-colors", { "bg-primary/10 text-primary": lang === 'ko' }]}>
          <Icon name="mdi:alpha-k-box" class="w-5 h-5" />
        </a>
        <a href="/en" title="English" class:list={["p-1 rounded-full hover:bg-surface-3 transition-colors", { "bg-primary/10 text-primary": lang === 'en' }]}>
          <Icon name="mdi:alpha-e-box" class="w-5 h-5" />
        </a>
      </div>
    </div>
  </div>

  <!-- Main Navigation -->
  <nav class="bg-white py-4">
    <div class="container mx-auto px-4 flex items-center justify-between">
      <a href={base} class="font-bold text-xl flex items-center gap-2">
        <img src="/assets/products/logo/COX LOGO.png" alt="COX Camera Logo" class="h-8" />
      </a>
      
      <!-- Desktop Menu -->
      <div class="hidden md:flex items-center gap-4">
        <ul class="flex items-center gap-8 text-base font-medium">
          {links.map(link => (
            <li class={link.subLinks ? 'relative group' : ''}>
              {link.subLinks ? (
                <>
                  <span class="cursor-default hover:text-primary transition-colors flex items-center gap-1">
                    {link.label} <Icon name="mdi:chevron-down" class="w-4 h-4" />
                  </span>
                  <ul class="absolute hidden group-hover:block bg-white shadow-md rounded-md py-2 w-40 z-50 top-full left-0">
                    {link.subLinks.map(subLink => (
                      <li>
                        <a href={subLink.href} class="block px-4 py-2 hover:bg-surface-2 transition-colors">
                          {subLink.label}
                        </a>
                      </li>
                    ))}
                  </ul>
                </>
              ) : (
                <a href={link.href} class="hover:text-primary transition-colors">
                  <span>{link.label}</span>
                </a>
              )}
            </li>
          ))}
        </ul>
        <button class="p-2 rounded-full hover:bg-surface-2 transition-colors">
          <Icon name="mdi:magnify" class="w-6 h-6 text-on-surface" />
        </button>
        <a href={`${base}/support`} class="bg-primary text-on-primary font-semibold py-2 px-5 rounded-full shadow-md hover:shadow-lg transition-shadow duration-300">
          문의하기
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button id="mobile-menu-button" class="p-2 rounded-md">
          <Icon name="mdi:menu" class="w-6 h-6" />
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden fixed inset-0 bg-white z-50">
    <div class="flex justify-between items-center p-4 border-b">
      <a href={base} class="font-bold text-xl flex items-center gap-2">
        <img src="/assets/products/logo/COX LOGO.png" alt="COX Camera Logo" class="h-8" />
      </a>
      <button id="mobile-menu-close-button" class="p-2 rounded-md">
        <Icon name="mdi:close" class="w-6 h-6" />
      </button>
    </div>
    <ul class="flex flex-col p-4 space-y-4">
      {links.map(link => (
        <li>
          {link.subLinks ? (
            <div>
              <span class="font-semibold text-lg flex justify-between items-center">
                {link.label}
                <Icon name="mdi:chevron-down" class="w-5 h-5" />
              </span>
              <ul class="pl-4 mt-2 space-y-2">
                {link.subLinks.map(subLink => (
                  <li>
                    <a href={subLink.href} class="block py-2 text-on-surface-variant hover:text-primary">
                      {subLink.label}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          ) : (
            <a href={link.href} class="font-semibold text-lg hover:text-primary">
              {link.label}
            </a>
          )}
        </li>
      ))}
    </ul>
  </div>
</header>

<script>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenuCloseButton = document.getElementById('mobile-menu-close-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton.addEventListener('click', () => {
    mobileMenu.classList.remove('hidden');
  });

  mobileMenuCloseButton.addEventListener('click', () => {
    mobileMenu.classList.add('hidden');
  });
</script>